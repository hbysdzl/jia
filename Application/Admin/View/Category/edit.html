<layout name="Public/layout"/>
<style>
#tabbar-div{font-size:18px;width:20%;height:30px;text-align:center;}
#tabbar-div ul li{list-style-type:none;float:left;line-height:28px;width:50%;cursor:pointer;border:1px #d8ef3a solid;}
.tab-front{background:#4ca90f;};
</style>
 <div class="page-heading">
 <h3>{$title}</h3>
 <ul class="breadcrumb">
    <li><a href="#">控制面板</a></li>
    <li><a href="{:U('cateList')}">返回</a></li>
    <li class="active"> Editable Table </li>
</ul>
</div>
<div class="wrapper">
    <div class="row">
        <div class="col-sm-12">
            <section class="panel">
                <header class="panel-heading">
                    <span class="tools pull-right">
                        <a href="javascript:;" class="fa fa-chevron-down"></a>
                        <a href="javascript:;" class="fa fa-times"></a>
                    </span>
				<div id="tabbar-div">
					<ul>
						<li class="tab-front">基本信息</li>
						<li class="tab-back">扩展</li>
					
					</ul>
				</div>
                </header>
<form id="form_data">    
<table class="table_content" style="width:100%;height:650px;margin-left:10px;font-size:16px">
	<input type="hidden" name="id" value="{$cat_arr.id}">
    <tr><td><span style="color:red">*</span>上级分类:</td></tr>
   	<tr>
   		<td>
   			<select name="pid" style="width:340px">
   				<option value='0'>----顶级分类-----</option>
   				<volist name="one_cat" id='vo'>
   					<?php if($cat_arr['pid']==$vo['id']):?>
   						<option value="{$vo.id}" selected="selected">{$vo.title}</option>
   					<?php else:?>
   						<option value="{$vo.id}">{$vo.title}</option>
   					<?php endif;?>
 				</volist>  				
   			</select>
   		</td>
   </tr>
   	<tr><td><span style="color:red">*</span>分类名称:</td></tr>
   	<tr><td><input type="text" name="title"  size="40" value="{$cat_arr.title}"/></td></tr>
    <tr><td><span style="color:red">*</span>分类标识:</td></tr>
    <tr><td><input type="text" name="name" size='40' value="{$cat_arr.name}"></td></tr>
   
    <tr><td><span style="color:red">*</span>发布内容:</td></tr>
   	<tr>
   		<td>
   			<input type='radio' value="0" name="allow_publish" <?php echo $cat_arr['allow_publish']==0? 'checked="checked"':''?>>不允许&nbsp&nbsp&nbsp&nbsp
   			<input type='radio' value="1" name="allow_publish" <?php echo $cat_arr['allow_publish']==1? 'checked="checked"':''?>>仅允许后台&nbsp&nbsp&nbsp&nbsp
   			<input type='radio' value="2" name="allow_publish" <?php echo $cat_arr['allow_publish']==2? 'checked="checked"':''?>>仅允许前台
   		</td>
    </tr> 
     <tr><td><span style="color:red">*</span>是否审核:（在分类下添加的文章是否需要审核）</td></tr>
   	<tr>
   		<td>
   			<input type='radio' value="0" name="check"<?php echo $cat_arr['check']==0? 'checked="checked"':''?>>需要&nbsp&nbsp&nbsp&nbsp
   			<input type='radio' value="1" name="check" <?php echo $cat_arr['check']==1? 'checked="checked"':''?>>不需要
   		</td>
    </tr>
     <tr><td><span style="color:red">*</span>绑定文档模型</td></tr>
    <tr>
   		<td>
   			<input type='checkbox' value="2" name="model[]" <?php echo stripos($cat_arr['model'],'2')===false?'':'checked="checked"'?>>文章文档&nbsp&nbsp&nbsp&nbsp
   			<input type='checkbox' value="3" name="model[]" <?php echo stripos($cat_arr['model'],'3')===false?'':'checked="checked"'?>>下载文档
   		</td>
    </tr>
    <tr><td><span style="color:red">*</span>允许文档类型</td></tr>
    <tr>
   		<td>
   			<input type='checkbox' value="2" name="type[]" <?php echo stripos($cat_arr['type'],'2')===false?'':'checked="checked"'?>>主题&nbsp&nbsp&nbsp&nbsp
   			<input type='checkbox' value="1" name="type[]"<?php echo stripos($cat_arr['type'],'1')===false?'':'checked="checked"'?>>目录&nbsp&nbsp&nbsp&nbsp
   			<input type='checkbox' value="3" name="type[]"<?php echo stripos($cat_arr['type'],'3')===false?'':'checked="checked"'?>>段落
   		</td>
    </tr>
    <tr><td><span style="color:red">*</span>可见性（是否对用户可见，针对前台）：
			<select name="display">
				<option value="1" <?php echo $cat_arr['display']==1?'selected="selected"':''?>>所有人可见</option>
				<option value="0" <?php echo $cat_arr['display']==0?'selected="selected"':''?>>不可见</option>
				<option value="2" <?php echo $cat_arr['display']==2?'selected="selected"':''?>>管理员可见</option>
			</select>	
		</td>
	</tr>
	<tr>
		<td>
			<span style="color:red">*</span>回复（是否允许对内容进行回复，需要详情页模板支持回复显示与提交）：
			<input type="radio" name="reply" value='1' <?php echo $cat_arr['reply']==1?'checked="checked"':''?>>允许&nbsp&nbsp&nbsp&nbsp
			<input type="radio" name="reply" value='0'<?php echo $cat_arr['reply']==0?'checked="checked"':''?>>不允许
		</td>
	</tr>
	
	<tr><td><span style="color:red">*</span>排序（仅对当前层级有效）：<input type="text" name="sort" value='{$cat_arr.sort}' size='8'></td></tr>
	<tr>
		<td><span style="color:red">*</span>列表行数：&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
			<input type="text" name="list_row" value="{$cat_arr.list_row}" size='10'>
		</td>
	</tr>                                       
</table>

<table class="table_content" style="display:none;width:100%;height:800px;margin-left:10px;font-size:16px;">		
	
	<tr><td>网页标题:&nbsp&nbsp<input type="text" name="meta_title" size='40' value="{$cat_arr.meta_title}"></td></tr>
	
	<tr><td><span style="color:red">*</span>关键字：</td></tr>
	<tr><td><textarea name="keywords" rows='8' cols='50'>{$cat_arr.keywords}</textarea></td></tr>
	
	
	<tr><td><span style="color:red">*</span>描述：</td></tr>
	<tr><td><textarea name="description" rows='8' cols='50'>{$cat_arr.description}</textarea></td></tr>
	
	<tr><td><span style="color:red">*</span>频道模板：</td></tr>
	<tr><td><input type="text" name="template_index" size='50' value="{$cat_arr.template_index}"></td></tr>
	
	<tr><td><span style="color:red">*</span>列表模板：</td></tr>
	<tr><td><input type="text" name="template_lists" size='50' value="{$cat_arr.template_lists}"></td></tr>
	
	<tr><td><span style="color:red">*</span>详情模板：</td></tr>
	<tr><td><input type="text" name="template_detail" size='50' value="{$cat_arr.template_detail}"></td></tr>
	
	<tr><td><span style="color:red">*</span>编辑模板：</td></tr>
	<tr><td><input type="text" name="template_edit" size='50' value="{$cat_arr.template_edit}"></td></tr>
	
	<tr><td><span style="color:red">*</span>状态：<td/></tr>
	<tr>
		<td>
			<input type="radio" name="status" value="1" <?php echo $cat_arr['status']==1?'checked="checked"':''?>>启用&nbsp&nbsp&nbsp
			<input type="radio" name="status" value="0" <?php echo $cat_arr['status']==0?'checked="checked"':''?>>禁用
		</td>
	</tr>
</table>

<table>
	<tr>
      <td colspan=2><input type="button"  value="提交" id="tijiao"/> &nbsp &nbsp &nbsp<input type="reset"  value="重置" /></td>  
	</tr>
</table> 
</form> 
<div id="tishi" style="width:1650px;height:50px;background:#f66b34;color:white;line-height:50px;position:fixed;top:80px;font-size:22px;padding-left:50px;display:none"></div>     
</section>
<script src="__ROOT__/Application/Admin/Public/js/jquery-1.10.2.min.js"></script>

<script type="text/javascript">

// 点击按钮切换table
$("#tabbar-div ul li").click(function(){
	// 获取点击的是第几个按钮
	var i = $(this).index();
	// 显示第i个table
	$(".table_content").eq(i).show();
	// 隐藏其他的table
	$(".table_content").eq(i).siblings(".table_content").hide();
	// 把原来选中的取消选中状态
	$(".tab-front").removeClass("tab-front").addClass("tab-back");
	// 切换点击的按钮的样式为选中状态
	$(this).removeClass("tab-back").addClass("tab-front");
});

$('#tijiao').click(function(){
	var form = $('#form_data').serialize();
    $.ajax({
        url: "{:U('ajaxEdit')}",
        type: "post",
        data: form,
        dataType:"json",
        //processData: false,
        //contentType: false,
        success: function(data) {
        	if(data.ok==0){
				$('#tishi').html(data.error);
				$('#tishi').fadeIn(1000);
				$('#tishi').fadeOut(3000);
			}else{
				$('#tishi').html('操作成功正在跳转！');
				$('#tishi').fadeIn(1000);
				$('#tishi').fadeOut(3000);
				
					setTimeout(function(){
						location.href="{:U('cateList')}";
					},3000);
				
			}
        }
 
    });
	
});

</script>
 