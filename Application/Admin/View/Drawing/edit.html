<layout name="Public/layout"/>
<style type="text/css">
table{margin-top: -30px;}
tr{height: 35px;}
th{font-weight: bold;padding-top:18px;font-family:'微软雅黑';}
</style>
<div class="page-heading">
    <h3>{$title}</h3>
       <ul class="breadcrumb">
           <li><a href="javascript:void(0);">控制面板</a></li>
           <li><a href="{:U('index')}">返回</a></li>
           <li class="active"> Editable Table </li>
      </ul>
</div>

<div class="wrapper">
             <div class="row">
                <div class="col-sm-12">
                <section class="panel">
                <header class="panel-heading">
                    Editable Table
                    <span class="tools pull-right">
                        <a href="javascript:;" class="fa fa-chevron-down"></a>
                        <a href="javascript:;" class="fa fa-times"></a>
                     </span>
                </header>
                <div class="panel-body">
                <div class="adv-table editable-table ">
                <div class="clearfix">
                   
                </div>
                
        </div>
     </div>
<form id="form_data" action="__SELF__" method="post" enctype="multipart/form-data">
	<input type="hidden" name="id" value="{$res.id}">    
<table  style="width:50%;height:300px;margin-left:20px;font-size:16px">
    <tr><th>效果图名称:</th></tr>
    <tr><td><input type="text" name="name" size="47" value="{$res.name}"/> </td></tr>
   
    <tr><th>效果图封面 </th></tr>
    <tr><td><input type="file" name="img_url" id="file" onchange="c()"/></td></tr>
    <tr><td><img src="<?php echo C('IMG_PATH').'/'.$res['img_url'];?>" id="show" width='90px'></td></tr>
   
 	  <tr><th>效果图展示图片</th></tr>
	  <tr>
	  	<td>
	    <div style="border: 1px dashed; height:320px;width: 155%;text-align: center;background-color:#f3f3f3;">
	    <div style="margin-top:10px;">
	    	<volist name="resimg" id="vo">
	  		<span title="点击删除图片" id="{$vo.id}" class="pic" style="cursor: pointer;"><?php echo ShowImage($vo['img'],100);?></span>&nbsp&nbsp&nbsp;
	  		</volist>
	    </div>
	  	<div style="width:98%;height: 90%;margin:10px auto;text-align: center;" id="pcs"></div>
		<div style="margin-top:-100px;">
	  	  <input onclick="$(this).parent().parent().find('#pcs').append('<span style=\'float:left\'><input  type=\'file\' name=\'pics[]\' id=\'file\' /><br/></span>')" type="button" value="点击添加图片" />
	  	</div>
	  </div>
	 </td>
	 </tr>
  	<tr><th>几居室</th>   
    <tr><td><input type="text" name="room" size="47" value="{$res.room}"/></td></tr>
    <tr><th>面积</th>   
    <tr><td><input type="text" name="area" size="47" value="{$res.area}"/></td></tr>
    <tr><th>造价（如8.7万）</th>   
    <tr><td><input type="text" name="cost" size="47" value="{$res.cost}"/></td></tr>
   	<tr><th>设计师</th>   
    <tr>
    	<td>
    	<select name="worker">
    		<option value="">--请选择--</option>
    		<volist name="work" id="vo">
    		<?php if($res['workerid']==$vo['id']){
					$check='selected="selected"';
				}else{
					$check='';
				}
			?>
    		<option value="{$vo.id}-{$vo.name}" {$check}>--{$vo.name}--</option>
    		</volist>
    	</select>
    	</td>
   </tr>
   	<tr><th>风格</th></tr>
    <tr>
    	<td>
    		<volist name="res1" id="vo">
    		<?php if($res['ffg']==$vo['id']){
					$check='checked="checked"';
				}else{
					$check='';
				}
			?>
    		<input class="auth_rules" type="radio" name="ffg" value="{$vo.id}" {$check}>{$vo.name} &nbsp;&nbsp;&nbsp;&nbsp;
    		</volist>
    	</td>
   </tr>
   <tr><th>户型</th></tr>
    <tr>
    	<td>
    		<volist name="res2" id="vo">
    		<?php if($res['fhx']==$vo['id']){
					$check='checked="checked"';
				}else{
					$check='';
				}
			?>
    		<input class="auth_rules" type="radio" name="fhx" value="{$vo.id}" {$check}>{$vo.name}&nbsp;&nbsp;&nbsp;&nbsp;
    		</volist>
    	</td>
   </tr>
   <tr><th>面积</th></tr>
    <tr>
    	<td>
    		<volist name="res3" id="vo">
    		<?php if($res['fmj']==$vo['id']){
					$check='checked="checked"';
				}else{
					$check='';
				}
			?>
    		<input class="auth_rules" type="radio" name="fmj" value="{$vo.id}" {$check}>{$vo.name}&nbsp;&nbsp;&nbsp;&nbsp;
    		</volist>
    	</td>
   </tr>
   <tr><th>造价</th></tr>
    <tr>
    	<td>
    		<volist name="res4" id="vo">
    		<?php if($res['fzj']==$vo['id']){
					$check='checked="checked"';
				}else{
					$check='';
				}
			?>
    		<input class="auth_rules" type="radio" name="fzj" value="{$vo.id}" {$check}>{$vo.name}&nbsp;&nbsp;&nbsp;&nbsp;
    		</volist>
    	</td>
   </tr>
   <tr><th>描述</th> </tr> 
   <tr><td><textarea name="description" style="height:200px;width:400px">{$res.description}</textarea></td></tr>    
   	
   	<tr>
      <td colspan=2><input type="submit"  value="提交" id="tijiao"/> &nbsp &nbsp &nbsp<input type="reset"  value="重置" /></td>  
   	</tr>   
   	               
</table>
</form> 
<div id="tishi" style="width:1650px;height:50px;background:#f66b34;color:white;line-height:50px;position:fixed;top:60px;font-size:22px;padding-left:50px;display:none"></div>     
</section>
<script src="__ROOT__/Application/Admin/Public/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
//上传图片预览
function c () {
	  var r= new FileReader();
	  f=document.getElementById('file').files[0];
	   
	  r.readAsDataURL(f);
	  r.onload=function (e) {
	    document.getElementById('show').src=this.result;
	  };
	}
	
//ajax删除图片

$('.pic').click(function(){
	//获取id
	var Id=$(this).attr('id');
	var span=$(this);
	//执行Ajax
	if(confirm("确定删除吗")){
		$.ajax({
			type:'get',
		    url:"{:U('ajaxDelImg','',false)}/id/"+Id,
		    dataType:"json",
		    success:function(data){
		    	if(data.ok==1){
		    		alert('删除成功！您可以重新上传更新');
		    		//将标签删除
		    		span.remove();
		    	}else{
		    		alert('删除失败！');
		    	}
		    }
		});
	}
	
});
</script>



